(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{"/tZr":function(e,t,a){"use strict";a.r(t);a("2qtc");var n,r,l,i,o,c,u,s,d,h=a("kLXV"),m=a("p0pE"),p=a.n(m),f=a("Y/ft"),g=a.n(f),v=a("2Taf"),y=a.n(v),C=a("vZ4D"),S=a.n(C),k=a("l4Ni"),w=a.n(k),E=a("ujKo"),b=a.n(E),I=a("MhPg"),D=a.n(I),O=a("q1tI"),x=a.n(O),L=a("MuoO"),U=a("zHco"),A=a("sgIW"),z=a("Vqex"),N=a("ww3E"),j=(a("5NDa"),a("5rEg")),q=(a("+BJd"),a("mr32")),P=(a("miYZ"),a("tsqr")),F=a("LaUL"),G=a("xY9O"),M=a("WuP6"),R=a("WYMx"),T=a("XeBE"),V=(a("iQDF"),a("+eQT")),Y=(a("giR+"),a("fyUT")),W=a("jehZ"),Z=a.n(W),B=(a("y8nQ"),a("Vl3Y")),H=a("wd/R"),J=a.n(H),Q=(n=B["a"].create(),n((l=function(e){function t(){var e,a;y()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=w()(this,(e=b()(t)).call.apply(e,[this].concat(r))),a.handleOk=function(){var e=a.props,t=e.form.validateFields,n=e.onOk,r=void 0===n?function(){}:n;t(function(e,t){e||(t.invoiceDate=J()(t.invoiceDate).format("YYYYMMDD"),t.invoiceMoney=t.invoiceMoney.toFixed(2),r(t))})},a.handleCancel=function(){var e=a.props.onCancel,t=void 0===e?function(){}:e;t()},a}return D()(t,e),S()(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form.getFieldDecorator,n={labelCol:{span:6},wrapperCol:{span:16}};return x.a.createElement(h["a"],{title:"\u53d1\u7968\u4fe1\u606f\u5f55\u5165",visible:t,onCancel:this.handleCancel,onOk:this.handleOk,okText:"\u63d0\u4ea4",destroyOnClose:!0},x.a.createElement(B["a"],null,x.a.createElement(B["a"].Item,Z()({label:"\u53d1\u7968\u4ee3\u7801"},n),a("invoiceCode",{rules:[{required:!0,message:"\u8be5\u9879\u5fc5\u586b\uff01"}]})(x.a.createElement(j["a"],null))),x.a.createElement(B["a"].Item,Z()({label:"\u53d1\u7968\u53f7\u7801"},n),a("invoiceNo",{rules:[{required:!0,message:"\u8be5\u9879\u5fc5\u586b\uff01"}]})(x.a.createElement(j["a"],null))),x.a.createElement(B["a"].Item,Z()({label:"\u53d1\u7968\u91d1\u989d"},n),a("invoiceMoney",{rules:[{required:!0,message:"\u8be5\u9879\u5fc5\u586b\uff01"}]})(x.a.createElement(Y["a"],{style:{width:"100%"},step:"0.01",precision:2,placeholder:"\u8bf7\u8f93\u5165\u5b8c\u6574\u91d1\u989d\uff1a100.20"}))),x.a.createElement(B["a"].Item,Z()({label:"\u53d1\u7968\u65f6\u95f4"},n),a("invoiceDate",{rules:[{required:!0,message:"\u8be5\u9879\u5fc5\u586b\uff01"}]})(x.a.createElement(V["a"],{style:{width:"100%"}}))),x.a.createElement(B["a"].Item,Z()({label:"\u6821\u9a8c\u7801\u540e\u516d\u4f4d"},n),a("checkCode",{})(x.a.createElement(j["a"],{placeholder:"\u666e\u7968\u3001\u7535\u5b50\u666e\u7968\u3001\u5377\u5f0f\u666e\u7968\u5fc5\u586b"})))))}}]),t}(O["PureComponent"]),r=l))||r),X=Q,_=a("d6i3"),K=a.n(_),$=a("1l/V"),ee=a.n($),te=a("j/8I"),ae="/api/v1/order",ne=function(){var e=ee()(K.a.mark(function e(t){return K.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(te["b"])("".concat(ae,"/selectOrderListPage"),"get",{params:t||{}}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=ee()(K.a.mark(function e(t){return K.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(te["b"])("".concat(ae,"/selectOrderDetails"),"get",{params:t||{}}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=ee()(K.a.mark(function e(t){return K.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(te["b"])("".concat(ae,"/save"),"post",{data:t||{}}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=ee()(K.a.mark(function e(t){return K.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(te["b"])("".concat(ae,"/audit"),"post",{data:t||{}}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),oe=(i=Object(L["connect"])(function(){return{}}),i((c=function(e){function t(){var e,a;y()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=w()(this,(e=b()(t)).call.apply(e,[this].concat(r))),a.state={galleryData:[],galleryVisible:!1,detail:{},chainList:[],remark:"",changeSignShow:!1,showInvoiceEntry:!1,qiniuUrl:null},a.fetchOrderDetail=function(){var e=a.props.orderId;re({orderId:e}).then(function(e){e&&e.success&&a.setState({detail:e.data.data,chainList:e.data.taskSignVOList,remark:""})})},a.handleShowGallery=function(e){e&&0!==e.length?a.setState({galleryVisible:!0,galleryData:e}):P["a"].warn("\u6ca1\u6709\u53ef\u4ee5\u67e5\u770b\u7684\u6587\u4ef6\uff01")},a.handleCloseGallery=function(){a.setState({galleryVisible:!1})},a.changeRemark=function(e){a.setState({remark:e.target.value})},a.approvePass=function(){var e=a.props.orderId,t=a.state.remark;h["a"].confirm({title:"\u63d0\u793a",content:"\u662f\u5426\u786e\u8ba4\u64cd\u4f5c",onOk:function(){ie({orderId:e,remark:t,auditStatus:1}).then(function(e){e&&e.success&&(P["a"].success("\u64cd\u4f5c\u6210\u529f\uff01"),a.fetchOrderDetail())})}})},a.changeSign=function(){a.setState({changeSignShow:!0})},a.handleConfirmChangeSign=function(e){var t=a.props.orderId;ie(p()({orderId:t,auditStatus:10},e)).then(function(e){e&&e.success&&(P["a"].success("\u64cd\u4f5c\u6210\u529f\uff01"),a.fetchOrderDetail(),a.handleCancleChangeSign())})},a.handleCancleChangeSign=function(){a.setState({changeSignShow:!1})},a.returnAcceptor=function(){var e=a.props.orderId,t=a.state.remark;t?h["a"].confirm({title:"\u63d0\u793a",content:"\u662f\u5426\u786e\u8ba4\u64cd\u4f5c",onOk:function(){ie({orderId:e,remark:t,auditStatus:3}).then(function(e){e&&e.success&&(P["a"].success("\u64cd\u4f5c\u6210\u529f\uff01"),a.fetchOrderDetail())})}}):P["a"].warn("\u8bf7\u586b\u5199\u5907\u6ce8\uff01")},a.approveReject=function(){var e=a.props.orderId,t=a.state.remark;t?h["a"].confirm({title:"\u63d0\u793a",content:"\u662f\u5426\u786e\u8ba4\u64cd\u4f5c",onOk:function(){ie({orderId:e,remark:t,auditStatus:2}).then(function(e){e&&e.success&&(P["a"].success("\u64cd\u4f5c\u6210\u529f\uff01"),a.fetchOrderDetail())})}}):P["a"].warn("\u8bf7\u586b\u5199\u5907\u6ce8\uff01")},a.handleShowInvoiceEntry=function(e){a.setState({showInvoiceEntry:!0,qiniuUrl:e})},a.handleConfirmInvoiceEntry=function(e){var t=a.props.orderId,n=a.state.qiniuUrl,r=Object.assign({},e,{orderId:t,qiniuUrl:n});le(r).then(function(e){e&&e.success&&(P["a"].success("\u64cd\u4f5c\u6210\u529f\uff01"),a.handleCancleInvoiceEntry(),a.fetchOrderDetail())})},a.handleCancleInvoiceEntry=function(){a.setState({showInvoiceEntry:!1})},a}return D()(t,e),S()(t,[{key:"componentDidMount",value:function(){this.fetchOrderDetail()}},{key:"render",value:function(){var e=this,t=this.state,a=t.galleryData,n=t.galleryVisible,r=t.detail,l=t.chainList,i=t.remark,o=t.changeSignShow,c=t.showInvoiceEntry,u=null,s=null;r.procurementInvoiceList&&r.procurementInvoiceList.length>0&&(u=x.a.createElement(O["Fragment"],null,r.procurementInvoiceList.map(function(t,a){return x.a.createElement("div",{key:a},t.checkStatusName&&x.a.createElement(q["a"],null,t.checkStatusName),null!=t.totalRemainSum&&x.a.createElement(q["a"],null,"\u5269\u4f59\u91d1\u989d".concat(t.totalRemainSum)),x.a.createElement(N["a"],{style:{marginRight:"10px"},size:"small",onClick:function(){return e.handleShowGallery([t.qiniuUrl])}},"\u67e5\u770b\u53d1\u7968"),null!=t.downloadUrl&&x.a.createElement(N["a"],{style:{marginRight:"10px"},size:"small",onClick:function(){return e.handleShowGallery([t.downloadUrl])}},"\u67e5\u770b\u539f\u4ef6"),null!=t.invoiceCheckButton&&1!==r.auditStatus&&x.a.createElement(N["a"],{size:"small",onClick:function(){return e.handleShowInvoiceEntry(t.qiniuUrl)}},"\u53d1\u7968\u4fe1\u606f\u5f55\u5165"))}),x.a.createElement(X,{visible:c,onOk:this.handleConfirmInvoiceEntry,onCancel:this.handleCancleInvoiceEntry}))),r.procurementInvoiceUrlList&&r.procurementInvoiceUrlList.length>0&&(s=x.a.createElement(N["a"],{size:"small",onClick:function(){return e.handleShowGallery(r.procurementInvoiceUrlList)}},"\u67e5\u770b\u53d1\u7968"));var d=x.a.createElement(O["Fragment"],null,u,s),h=0===r.auditStatus&&1===r.orderStatus&&r.isShowAudit;return x.a.createElement(O["Fragment"],null,x.a.createElement(F["a"],{data:[{label:"\u53d1\u8d77\u65b9",value:r.initiatorCompanyName},{label:"\u63a5\u6536\u65b9",value:r.acceptorCompanyName},{label:"\u91c7\u8d2d\u9879\u76ee",value:r.procurementProject},{label:"\u91c7\u8d2d\u91d1\u989d",value:r.procurementAmount},{label:"\u950c\u8d1d\u58f3\u6d41\u8f6c\u51ed\u8bc1",value:r.znContractDownloadUrl&&x.a.createElement(N["a"],{size:"small"},x.a.createElement("a",{target:"_blank",href:r.znContractDownloadUrl,rel:"noopener noreferrer"},"\u53bb\u4e0b\u8f7d"))},{label:"\u4ed8\u6b3e\u627f\u8bfa\u51fd",value:x.a.createElement(O["Fragment"],null,r.paymentContractUrls&&r.paymentContractUrls.map(function(e){return e?x.a.createElement(N["a"],{size:"small",key:e},x.a.createElement("a",{target:"_blank",href:e,rel:"noopener noreferrer"},"\u67e5\u770b\u4ed8\u6b3e\u627f\u8bfa\u51fd")):null}))},{label:"\u91c7\u8d2d\u5408\u540c",value:r.procurementContractList&&x.a.createElement(N["a"],{size:"small",onClick:function(){return e.handleShowGallery(r.procurementContractList)}},"\u67e5\u770b\u91c7\u8d2d\u5408\u540c")},{label:"\u7269\u6d41\u51ed\u8bc1",value:r.logisticsUrlList&&r.logisticsUrlList.length>0&&x.a.createElement(N["a"],{size:"small",onClick:function(){return e.handleShowGallery(r.logisticsUrlList)}},"\u67e5\u770b\u7269\u6d41\u51ed\u8bc1")},{label:"\u9500\u552e\u5408\u540c",value:r.saleContractList&&r.saleContractList.length>0&&x.a.createElement(N["a"],{size:"small",onClick:function(){return e.handleShowGallery(r.saleContractList)}},"\u67e5\u770b\u9500\u552e\u5408\u540c")},{label:"\u9500\u552e\u53d1\u7968",value:d},{label:"\u53d1\u7968\u603b\u989d",value:r.invoiceTotalAmount},{label:"\u53d1\u7968\u91d1\u989d\u5bf9\u6bd4",value:x.a.createElement(q["a"],null,r.compareOrderAndInvoiceAmount)},{label:"\u5230\u671f\u65f6\u95f4",value:r.expirationTime?r.expirationTime.split(" ")[0]:""},{label:"\u91c7\u8d2d\u5355\u72b6\u6001",value:x.a.createElement(q["a"],null,r.orderStatusName)},{label:"\u5907\u6ce8(\u539f\u56e0)",value:x.a.createElement(j["a"],{value:i,onChange:this.changeRemark})}]}),h&&x.a.createElement(R["a"],{globalWidth:!1,globalSize:"default",buttons:[{text:r.isCheckChangeSignAndAudit?"\u540c\u610f":"\u5ba1\u6838\u901a\u8fc7",onClick:this.approvePass},{text:"\u8f6c\u7b7e",onClick:this.changeSign,type:"pending"},{text:"\u9000\u56de\u63a5\u6536\u65b9",onClick:this.returnAcceptor,type:"warn",hide:r.isCheckChangeSignAndAudit},{text:r.isCheckChangeSignAndAudit?"\u4e0d\u540c\u610f":"\u5ba1\u6838\u62d2\u7edd",onClick:this.approveReject,type:"danger"}]}),x.a.createElement(M["a"],{data:l}),h&&x.a.createElement(T["a"],{visible:o,onCancel:this.handleCancleChangeSign,onOk:this.handleConfirmChangeSign}),n&&x.a.createElement(G["a"],{data:a,onClose:this.handleCloseGallery}))}}]),t}(O["PureComponent"]),o=c))||o),ce=oe,ue=(u=Object(L["connect"])(function(){return{}}),u((d=function(e){function t(){var e,a;y()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=w()(this,(e=b()(t)).call.apply(e,[this].concat(r))),a.state={showDetail:!1,dataSrouce:[],pagination:{current:1,pageSize:10,total:0},searchCondition:{},orderId:null},a.fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.pageNum,n=g()(e,["pageNum"]),r=a.state,l=r.pagination,i=r.searchCondition;ne(p()({pageSize:l.pageSize,pageNum:t||l.current},i,n)).then(function(e){e&&e.success&&a.setState({dataSrouce:e.data.list,pagination:p()({},l,{total:e.data.count})})})},a.handleFormSearch=function(e){var t=a.state.pagination;a.setState({searchCondition:e,pagination:p()({},t,{current:1})},function(){a.fetchData()})},a.handleChangePage=function(e){var t=a.state.pagination;a.setState({pagination:p()({},t,{current:e})},function(){a.fetchData({pageNum:e})})},a.handleHideDetail=function(){a.setState({showDetail:!1}),a.fetchData()},a.handleShowDetail=function(e){a.setState({showDetail:!0,orderId:e})},a}return D()(t,e),S()(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this,t=this.state,a=t.showDetail,n=t.dataSrouce,r=t.pagination,l=t.orderId;return x.a.createElement(U["a"],null,x.a.createElement(A["a"],{data:[{label:"\u4f01\u4e1a\u540d\u79f0",type:"input",key:"companyName"},{label:"\u72b6\u6001",type:"select",options:[{key:"0",value:"\u672a\u5ba1\u6838"},{key:"1",value:"\u5df2\u5ba1\u6838"},{key:"2",value:"\u5ba1\u6838\u5931\u8d25"},{key:"3",value:"\u5ba1\u6838\u9000\u56de"}],key:"auditStatus"}],buttonGroup:[{onSearch:this.handleFormSearch}]}),x.a.createElement(z["a"],{columns:[{title:" \u53d1\u8d77\u65b9",dataIndex:"initiatorCompanyName"},{title:"\u63a5\u6536\u65b9",dataIndex:"acceptorCompanyName"},{dataIndex:"procurementAmount",title:"\u91c7\u8d2d\u91d1\u989d",type:"amount"},{dataIndex:"orderStatusName",title:"\u91c7\u8d2d\u5355\u72b6\u6001"},{dataIndex:"expirationTime",title:"\u5230\u671f\u65f6\u95f4",render:function(e){return e?e.split(" ")[0]:e}},{dataIndex:"auditStatusName",title:"\u5ba1\u6838\u72b6\u6001"},{dataIndex:"comfirmExpirationTime",title:"\u786e\u8ba4\u5230\u671f\u65f6\u95f4"},{dataIndex:"procurementProject",title:"\u91c7\u8d2d\u9879\u76ee"},{dataIndex:"gmtCreate",title:"\u521b\u5efa\u65f6\u95f4"},{type:"oprate",render:function(t,a){var n=a.orderStatus,r=a.auditStatus,l=a.isShowAudit,i=a.orderId,o="\u8be6\u60c5",c="default";return 1===n&&0===r?(o=l?"\u5ba1\u6838":"\u5f85\u5ba1\u6838",c="primary"):9===r&&(o="\u5ba1\u6838\u4e2d",c="pending"),x.a.createElement(N["a"],{onClick:function(){return e.handleShowDetail(i)},size:"small",type:c},o)}}],dataSource:n,pagination:p()({},r,{onChange:this.handleChangePage})}),x.a.createElement(h["a"],{title:"\u8ba2\u5355\u8bb0\u5f55",footer:null,width:680,destroyOnClose:!0,visible:a,onCancel:this.handleHideDetail},x.a.createElement(ce,{orderId:l})))}}]),t}(O["PureComponent"]),s=d))||s);t["default"]=ue}}]);